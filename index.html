<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tempting Image Viewer</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        background-color: #f0f0f0;
      }
      .image-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        max-width: 1200px;
        margin: 20px auto;
      }
      .image-container {
        position: relative;
        aspect-ratio: 16 / 9;
        overflow: hidden;
        border-radius: 10px;
        cursor: pointer;
      }
      .image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .blur-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
      }
      .blur-overlay::after {
        content: 'Allow location to view';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #fff;
        background: rgba(0, 0, 0, 0.7);
        padding: 10px 15px;
        border-radius: 5px;
        font-size: 14px;
      }
      .teaser-circle {
        position: absolute;
        width: 100px;
        height: 100px;
        border-radius: 50%;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        overflow: hidden;
        pointer-events: none;
      }
      #locationStatus {
        text-align: center;
        margin: 20px;
        max-width: 600px;
        font-size: 18px;
      }
      #allowLocationBtn {
        margin-top: 10px;
        padding: 10px 20px;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
      }
      #allowLocationBtn:hover {
        background-color: #45a049;
      }
    </style>
  </head>
  <body>
    <div id="locationStatus">
      Allow access to your location to fully reveal the images
    </div>
    <button id="allowLocationBtn">Allow Location Access</button>
    <div class="image-grid" id="imageGrid">
      <!-- We'll populate this with JavaScript -->
    </div>

    <script>
      const imageGrid = document.getElementById('imageGrid');
      const locationStatus = document.getElementById('locationStatus');
      const allowLocationBtn = document.getElementById('allowLocationBtn');
      const imagePath =
        'https://images.unsplash.com/photo-1699111407196-88aa06da1b80?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D';

      function createImageGrid() {
        for (let i = 0; i < 9; i++) {
          const container = document.createElement('div');
          container.className = 'image-container';
          const img = document.createElement('img');
          img.src = imagePath;
          img.alt = `Image ${i + 1}`;
          container.appendChild(img);

          const blurOverlay = document.createElement('div');
          blurOverlay.className = 'blur-overlay';
          container.appendChild(blurOverlay);

          const teaserCircle = document.createElement('div');
          teaserCircle.className = 'teaser-circle';
          teaserCircle.style.backgroundImage = `url(${imagePath})`;
          teaserCircle.style.backgroundPosition = 'center';
          teaserCircle.style.backgroundSize = '500%';
          container.appendChild(teaserCircle);

          imageGrid.appendChild(container);
        }
      }

      function requestLocationPermission() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            showImages,
            handleLocationError,
            {
              enableHighAccuracy: true,
              timeout: 5000,
              maximumAge: 0,
            }
          );
        } else {
          locationStatus.textContent =
            'Geolocation is not supported by this browser.';
        }
      }

      function showImages(position) {
        document
          .querySelectorAll('.blur-overlay, .teaser-circle')
          .forEach((el) => {
            el.style.display = 'none';
          });
        locationStatus.textContent = `Images revealed! Your location: ${position.coords.latitude.toFixed(
          2
        )}, ${position.coords.longitude.toFixed(2)}`;
        allowLocationBtn.style.display = 'none';
      }

      function handleLocationError(error) {
        console.error('Geolocation error:', error);
        switch (error.code) {
          case error.PERMISSION_DENIED:
            locationStatus.textContent =
              'Location access was denied. Click an image or the button below to try again.';
            break;
          case error.POSITION_UNAVAILABLE:
            locationStatus.textContent =
              'Location information is unavailable. Please try again.';
            break;
          case error.TIMEOUT:
            locationStatus.textContent =
              'The request to get user location timed out. Please try again.';
            break;
          default:
            locationStatus.textContent =
              'An unknown error occurred. Please try again.';
            break;
        }
        allowLocationBtn.style.display = 'block';
      }

      // Event listeners
      window.addEventListener('load', () => {
        createImageGrid();
      });

      allowLocationBtn.addEventListener('click', requestLocationPermission);

      imageGrid.addEventListener('click', (event) => {
        if (event.target.closest('.image-container')) {
          requestLocationPermission();
        }
      });
    </script>
  </body>
</html>
